------------------------------------------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                                                      Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
------------------------------------------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                                          cudaLaunchKernel        66.93%        3.476s        66.96%        3.478s       6.440us       0.000us         0.00%       0.000us       0.000us        540000  
void at::native::elementwise_kernel<128, 2, at::native::gpu_kernel_impl<at::native::dir...         0.00%       0.000us         0.00%       0.000us       0.000us        1.655s         7.49%        1.655s      16.554us        100000  
                                                                                  cudaFree         9.68%     502.970ms         9.69%     502.995ms     167.665ms       0.000us         0.00%       0.000us       0.000us             3  
                                                                            cudaEventQuery         5.82%     302.403ms         5.82%     302.427ms       0.393us       0.000us         0.00%       0.000us       0.000us        769267  
                                                                    cudaDeviceGetAttribute         0.00%       3.000us         0.00%       3.000us       0.176us       0.000us         0.00%       0.000us       0.000us            17  
                                                                      cudaGetSymbolAddress         0.00%       1.000us         0.00%       1.000us       1.000us       0.000us         0.00%       0.000us       0.000us             1  
                                                                                cudaMalloc         1.29%      67.186ms         1.29%      67.188ms     839.850us       0.000us         0.00%       0.000us       0.000us            80  
                                                                    sgemm_128x128x8_NT_vec         0.00%       0.000us         0.00%       0.000us       0.000us        1.068s         4.83%        1.068s      53.389us         20000  
void at::native::reduce_kernel<128, 4, at::native::ReduceOp<float, at::native::MeanOps<...         0.00%       0.000us         0.00%       0.000us       0.000us     552.850ms         2.50%     552.850ms      27.642us         20000  
                                                                     cudaStreamIsCapturing         0.07%       3.600ms         0.07%       3.600ms       0.060us       0.000us         0.00%       0.000us       0.000us         60029  
                                                       cudaThreadExchangeStreamCaptureMode         0.00%      94.000us         0.00%      94.000us       0.783us       0.000us         0.00%       0.000us       0.000us           120  
                                                                             cudaHostAlloc         0.32%      16.861ms         0.33%      16.893ms       5.631ms       0.000us         0.00%       0.000us       0.000us             3  
                                                                 cudaStreamCreateWithFlags         0.03%       1.440ms         0.03%       1.440ms      40.000us       0.000us         0.00%       0.000us       0.000us            36  
                                                                     cudaDeviceGetPCIBusId         0.00%      93.000us         0.00%      93.000us       0.331us       0.000us         0.00%       0.000us       0.000us           281  
                                                                      cudaDriverGetVersion         0.00%       1.000us         0.00%       1.000us       1.000us       0.000us         0.00%       0.000us       0.000us             1  
                                                                        cudaGetDeviceCount         0.00%       2.000us         0.00%       2.000us       0.019us       0.000us         0.00%       0.000us       0.000us           108  
                                                                   cudaDeviceCanAccessPeer         0.00%      10.000us         0.00%      10.000us       0.185us       0.000us         0.00%       0.000us       0.000us            54  
                                                                           cudaMemsetAsync         0.02%       1.145ms         0.02%       1.156ms      24.083us       0.000us         0.00%       0.000us       0.000us            48  
                                                                           Memset (Device)         0.00%       0.000us         0.00%       0.000us       0.000us     478.000us         0.00%     478.000us       9.958us            48  
                                                                     cudaStreamSynchronize         0.01%     626.000us         0.01%     626.000us      17.886us       0.000us         0.00%       0.000us       0.000us            35  
                                                                         cudaStreamDestroy         0.33%      17.038ms         0.33%      17.038ms     501.118us       0.000us         0.00%       0.000us       0.000us            34  
                                                                       cudaIpcGetMemHandle         0.03%       1.323ms         0.03%       1.323ms      44.100us       0.000us         0.00%       0.000us       0.000us            30  
                                                                      cudaIpcOpenMemHandle         0.27%      14.279ms         0.27%      14.279ms     475.967us       0.000us         0.00%       0.000us       0.000us            30  
                                                                           cudaMemcpyAsync        12.59%     654.008ms        12.60%     654.139ms       8.173us       0.000us         0.00%       0.000us       0.000us         80039  
                                                          Memcpy HtoD (Pageable -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us      41.000us         0.00%      41.000us       1.051us            39  
                                                                       cudaStreamWaitEvent         2.01%     104.324ms         2.01%     104.326ms       0.435us       0.000us         0.00%       0.000us       0.000us        240000  
                                                                                   INVALID         0.04%       1.833ms         0.04%       1.833ms       0.031us       0.000us         0.00%       0.000us       0.000us         60000  
            ncclKernel_AllReduce_RING_LL_Sum_float(ncclDevComm*, unsigned long, ncclWork*)         0.00%       0.000us         0.00%       0.000us       0.000us        4.176s        18.89%        4.176s     104.393us         40000  
void at::native::elementwise_kernel<128, 2, at::native::gpu_kernel_impl<at::native::CUD...         0.00%       0.000us         0.00%       0.000us       0.000us     508.180ms         2.30%     508.180ms      12.704us         40000  
void gemmSN_NN_kernel<float, 128, 2, 4, 8, 4, 4, false, cublasGemvTensorStridedBatched<...         0.00%       0.000us         0.00%       0.000us       0.000us     650.527ms         2.94%     650.527ms      32.526us         20000  
void at::native::reduce_kernel<128, 4, at::native::ReduceOp<float, at::native::func_wra...         0.00%       0.000us         0.00%       0.000us       0.000us        1.121s         5.07%        1.121s      28.019us         40000  
void at::native::(anonymous namespace)::CatArrayBatchedCopy<float, unsigned int, 4, 128...         0.00%       0.000us         0.00%       0.000us       0.000us        1.072s         4.85%        1.072s      26.789us         40000  
                                    cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags         0.40%      20.589ms         0.40%      20.590ms       1.030us       0.000us         0.00%       0.000us       0.000us         20000  
void gemv2T_kernel_val<int, int, float, float, float, float, 128, 16, 2, 2, false, fals...         0.00%       0.000us         0.00%       0.000us       0.000us     577.465ms         2.61%     577.465ms      28.873us         20000  
void at::native::vectorized_elementwise_kernel<4, at::native::FillFunctor<float>, at::d...         0.00%       0.000us         0.00%       0.000us       0.000us     129.187ms         0.58%     129.187ms       3.230us         40000  
void at::native::vectorized_elementwise_kernel<4, at::native::AUnaryFunctor<float, floa...         0.00%       0.000us         0.00%       0.000us       0.000us     191.379ms         0.87%     191.379ms       3.190us         60000  
void at::native::vectorized_elementwise_kernel<4, at::native::CUDAFunctor_add<float>, a...         0.00%       0.000us         0.00%       0.000us       0.000us      63.905ms         0.29%      63.905ms       3.195us         20000  
                                                                   maxwell_sgemm_128x64_nn         0.00%       0.000us         0.00%       0.000us       0.000us     776.676ms         3.51%     776.676ms      38.834us         20000  
void at::native::vectorized_elementwise_kernel<4, at::native::reciprocal_kernel_cuda(at...         0.00%       0.000us         0.00%       0.000us       0.000us      81.306ms         0.37%      81.306ms       4.065us         20000  
void at::native::elementwise_kernel<128, 2, at::native::gpu_kernel_impl<at::native::Bin...         0.00%       0.000us         0.00%       0.000us       0.000us     247.310ms         1.12%     247.310ms      12.366us         20000  
           ncclKernel_AllGather_RING_LL_Sum_int8_t(ncclDevComm*, unsigned long, ncclWork*)         0.00%       0.000us         0.00%       0.000us       0.000us        8.245s        37.29%        8.245s     412.233us         20000  
                                                            Memcpy DtoD (Device -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us     992.135ms         4.49%     992.135ms      12.402us         80000  
                                                                     cudaDeviceSynchronize         0.14%       7.528ms         0.14%       7.528ms       7.528ms       0.000us         0.00%       0.000us       0.000us             1  
------------------------------------------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 5.194s
Self CUDA time total: 22.107s

