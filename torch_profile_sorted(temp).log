------------------------------------------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                                                      Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
------------------------------------------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                                          cudaLaunchKernel        76.12%        3.631s        76.13%        3.631s      12.969us       0.000us         0.00%       0.000us       0.000us        280000  
void at::native::elementwise_kernel<128, 2, at::native::gpu_kernel_impl<at::native::dir...    0     0.00%       0.000us         0.00%       0.000us       0.000us     828.377ms         6.34%     828.377ms      16.568us         50000  
                                                                                  cudaFree        10.58%     504.811ms        10.58%     504.834ms     168.278ms       0.000us         0.00%       0.000us       0.000us             3  
                                                                            cudaEventQuery         3.50%     166.721ms         3.50%     166.755ms       0.446us       0.000us         0.00%       0.000us       0.000us        373477  
                                                                    cudaDeviceGetAttribute         0.00%       5.000us         0.00%       5.000us       0.294us       0.000us         0.00%       0.000us       0.000us            17  
                                                                      cudaGetSymbolAddress         0.00%       4.000us         0.00%       4.000us       4.000us       0.000us         0.00%       0.000us       0.000us             1  
                                                                                cudaMalloc         0.95%      45.503ms         0.95%      45.503ms     523.023us       0.000us         0.00%       0.000us       0.000us            87  
                                                                    sgemm_128x128x8_NT_vec         0.00%       0.000us         0.00%       0.000us       0.000us     531.179ms         4.07%     531.179ms      53.118us         10000  
void at::native::reduce_kernel<128, 4, at::native::ReduceOp<float, at::native::MeanOps<...    1    0.00%       0.000us         0.00%       0.000us       0.000us     294.606ms         2.26%     294.606ms      29.461us         10000  
                                                                     cudaStreamIsCapturing         0.05%       2.299ms         0.05%       2.299ms       0.077us       0.000us         0.00%       0.000us       0.000us         30038  
                                                       cudaThreadExchangeStreamCaptureMode         0.00%      82.000us         0.00%      82.000us       0.707us       0.000us         0.00%       0.000us       0.000us           116  
                                                                             cudaHostAlloc         0.30%      14.434ms         0.30%      14.434ms       4.811ms       0.000us         0.00%       0.000us       0.000us             3  
                                                                 cudaStreamCreateWithFlags         0.03%       1.283ms         0.03%       1.283ms      37.735us       0.000us         0.00%       0.000us       0.000us            34  
                                                                     cudaDeviceGetPCIBusId         0.00%     207.000us         0.00%     207.000us       0.726us       0.000us         0.00%       0.000us       0.000us           285  
                                                                      cudaDriverGetVersion         0.00%       1.000us         0.00%       1.000us       1.000us       0.000us         0.00%       0.000us       0.000us             1  
                                                                        cudaGetDeviceCount         0.00%       3.000us         0.00%       3.000us       0.029us       0.000us         0.00%       0.000us       0.000us           104  
                                                                   cudaDeviceCanAccessPeer         0.00%      13.000us         0.00%      13.000us       0.250us       0.000us         0.00%       0.000us       0.000us            52  
                                                                           cudaMemsetAsync         0.02%       1.063ms         0.02%       1.063ms      23.109us       0.000us         0.00%       0.000us       0.000us            46  
                                                                           Memset (Device)         0.00%       0.000us         0.00%       0.000us       0.000us     433.000us         0.00%     433.000us       9.413us            46  
                                                                     cudaStreamSynchronize         0.01%     577.000us         0.01%     577.000us      17.485us       0.000us         0.00%       0.000us       0.000us            33  
                                                                         cudaStreamDestroy         0.01%     274.000us         0.01%     274.000us       8.562us       0.000us         0.00%       0.000us       0.000us            32  
                                                                       cudaIpcGetMemHandle         0.03%       1.413ms         0.03%       1.413ms      50.464us       0.000us         0.00%       0.000us       0.000us            28  
                                                                      cudaIpcOpenMemHandle         0.34%      16.053ms         0.34%      16.053ms     573.321us       0.000us         0.00%       0.000us       0.000us            28  
                                                                           cudaMemcpyAsync         6.71%     320.072ms         6.71%     320.165ms       7.997us       0.000us         0.00%       0.000us       0.000us         40037  
                                                          Memcpy HtoD (Pageable -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us      39.000us         0.00%      39.000us       1.054us            37  
                                                                       cudaStreamWaitEvent         1.05%      49.968ms         1.05%      49.968ms       0.416us       0.000us         0.00%       0.000us       0.000us        120000  
                                                                                   INVALID         0.01%     528.000us         0.01%     528.000us       0.018us       0.000us         0.00%       0.000us       0.000us         30000  
            ncclKernel_AllReduce_RING_LL_Sum_float(ncclDevComm*, unsigned long, ncclWork*)         0.00%       0.000us         0.00%       0.000us       0.000us        3.059s        23.43%        3.059s     152.957us         20000  
                                    cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags         0.24%      11.402ms         0.24%      11.402ms       1.140us       0.000us         0.00%       0.000us       0.000us         10000  
void at::native::elementwise_kernel<128, 2, at::native::gpu_kernel_impl<at::native::CUD...         0.00%       0.000us         0.00%       0.000us       0.000us     262.381ms         2.01%     262.381ms      13.119us         20000  
void gemmSN_NN_kernel<float, 128, 2, 4, 8, 4, 4, false, cublasGemvTensorStridedBatched<...    2     0.00%       0.000us         0.00%       0.000us       0.000us     322.741ms         2.47%     322.741ms      32.274us         10000  
void at::native::reduce_kernel<128, 4, at::native::ReduceOp<float, at::native::func_wra...   3      0.00%       0.000us         0.00%       0.000us       0.000us     575.516ms         4.41%     575.516ms      28.776us         20000  
void at::native::(anonymous namespace)::CatArrayBatchedCopy<float, unsigned int, 4, 128...         0.00%       0.000us         0.00%       0.000us       0.000us     536.521ms         4.11%     536.521ms      26.826us         20000  
void gemv2T_kernel_val<int, int, float, float, float, float, 128, 16, 2, 2, false, fals...    4     0.00%       0.000us         0.00%       0.000us       0.000us     284.102ms         2.18%     284.102ms      28.410us         10000  
void at::native::vectorized_elementwise_kernel<4, at::native::FillFunctor<float>, at::d...         0.00%       0.000us         0.00%       0.000us       0.000us      64.115ms         0.49%      64.115ms       3.206us         20000  
void at::native::vectorized_elementwise_kernel<4, at::native::AUnaryFunctor<float, floa...         0.00%       0.000us         0.00%       0.000us       0.000us     132.277ms         1.01%     132.277ms       3.307us         40000  
void at::native::vectorized_elementwise_kernel<4, at::native::CUDAFunctor_add<float>, a...   5      0.00%       0.000us         0.00%       0.000us       0.000us      32.605ms         0.25%      32.605ms       3.260us         10000  
                                                                   maxwell_sgemm_128x64_nn         0.00%       0.000us         0.00%       0.000us       0.000us     383.744ms         2.94%     383.744ms      38.374us         10000  
void at::native::vectorized_elementwise_kernel<4, at::native::reciprocal_kernel_cuda(at...   6      0.00%       0.000us         0.00%       0.000us       0.000us      42.940ms         0.33%      42.940ms       4.294us         10000  
void at::native::elementwise_kernel<128, 2, at::native::gpu_kernel_impl<at::native::Bin...         0.00%       0.000us         0.00%       0.000us       0.000us     120.411ms         0.92%     120.411ms      12.041us         10000  
           ncclKernel_AllGather_RING_LL_Sum_int8_t(ncclDevComm*, unsigned long, ncclWork*)         0.00%       0.000us         0.00%       0.000us       0.000us        5.079s        38.90%        5.079s     507.850us         10000  
                                                            Memcpy DtoD (Device -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us     506.682ms         3.88%     506.682ms      12.667us         40000  
                                                                     cudaDeviceSynchronize         0.05%       2.160ms         0.05%       2.160ms       2.160ms       0.000us         0.00%       0.000us       0.000us             1  
------------------------------------------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 4.770s
Self CUDA time total: 13.056s

